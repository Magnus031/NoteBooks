# <center>跨域</center>

> 跨域，比较常见的出现在前后端分离开发的时候，前端的代码和后端的代码分别部署在不同的服务器上，这时候就会出现跨域问题。从一个域名的网页去请求另一个域名的资源的时候，因为域名、端口、协议的不同，都是跨域。

### 什么是浏览器的 **同源策略**?

**同源策略** 是浏览器的最核心也是最基本的安全功能。

**出现的目的就是**： 用于防止来自不同 **源** 的网页相互访问、操作或者篡改对方数据，从而避免恶意脚本或者网络攻击的行为。用于隔离不同来源的网页，以确保它们不会相互干扰或者窃取敏感信息。

什么是源?

- **协议**
- **域名**
- **端口号** 

这三者任意一个不同，就会被认为是跨域。

#### 四个原则

- **DOM** 原则： 一个网页只能访问与操作与其同源的页面的 DOM。
- **Cookies和储存** : 浏览器只允许同源的网页访问和修改其相关的cookies、localStorage等浏览器存储。不同源的网页不能访问对方的Cookie.
- **AJAX请求** : 一个网页只能向与自己同源的服务器发起 AJAX 请求。如果跨域请求被发送，浏览器会阻止这种请求，除非目标服务器明确允许跨域访问。

其实同 **源** 就可以理解成就是它自己本身。浏览器的同 **源** 策略其实就是为了保护用户的隐私和安全。

#### 跨域的解决方案 

1. CORS **跨域资源共享** Cross-Origin Resource Sharing
虽然同源策略阻止了不同源之间的交互，但是同时也带来了弊端，就是会限制一些正常的应用场景，就比如前后端开发的时候，前端想向后端发送请求，就是一个跨域的操作。正常来说就是会被拦截的。所以我们也给出相应的解决办法。


- 我们在 响应中添加 **Access-Control-Allow-Origin** 等头部，服务器就可以明确指定那些 **源** 是被允许的。

2. 代理服务器，在同一域内设置代理服务器，让代理服务器去请求其他域上的资源。


#### 流程
> 我们以前后端分离开发为例

- 浏览器发起跨域请求
- 服务器接收到请求，返回响应头 **Access-Control-Allow-Origin**
    - 如果响应中包含合法的 **Access-Control-Allow-Origin** 就表明，浏览器会允许JavaScript访问响应数据。
    - 否则的话浏览器就会阻止访问该数据。